{"version":3,"sources":["features/songs/lyrics/useLyrics.ts","features/songs/lyrics/LyricsDisplay.tsx"],"names":["timeout","ms","Promise","resolve","setTimeout","LyricsDisplay","data","source","useSWR","geniusSongId","a","fetch","res","text","start","substring","lastIndexOf","length","replace","suspense","useLyrics","Container","styled","pre"],"mappings":"8MAEA,SAASA,EAAQC,GACf,OAAO,IAAIC,SAAQ,SAACC,GAAD,OAAaC,WAAWD,EAASF,MAe/C,I,SCTQ,SAASI,EAAT,GAAwD,IAC7DC,EDQe,SAACC,GACxB,OAAOC,YAAO,UAAD,OACDD,EAAOE,cADN,sBAEX,gCAAAC,EAAA,sEACQV,EAAQ,KADhB,uBAEoBW,MAAM,4BAAD,OACOJ,EAAOE,aADd,cAFzB,cAEQG,EAFR,gBAKqBA,EAAIC,OALzB,cAKQA,EALR,OAMQC,EAAQ,oDANhB,kBASSD,EACJE,UACCF,EAAKG,YAAYF,GAASA,EAAMG,OAChCJ,EAAKG,YALG,kCAOTE,QAAQ,aAAc,OAd3B,4CAgBA,CAAEC,UAAU,IC3BGC,CADmD,EAA9Bb,QAC9BD,KAER,OAAO,cAACe,EAAD,UAAYf,IAGrB,IAAMe,EAAYC,IAAOC,IAAV","file":"static/js/7.df384538.chunk.js","sourcesContent":["import useSWR, { SWRResponse } from 'swr';\n\nfunction timeout(ms: number) {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n}\n\nexport interface LyricsSource {\n  provider: 'genius';\n  locale: 'zh_HK_R';\n  geniusSongId: string;\n}\n\ntype Lyrics = string;\n\ninterface SuspenseResponseInterface extends SWRResponse<Lyrics, any> {\n  data: Lyrics;\n}\n\nexport const useLyrics = (source: LyricsSource) => {\n  return useSWR(\n    `lyrics/${source.geniusSongId}`,\n    async () => {\n      await timeout(1000);\n      const res = await fetch(\n        `https://genius.com/songs/${source.geniusSongId}/embed.js`\n      );\n      const text = await res.text();\n      const start = '<div class=\\\\\\\\\\\\\"rg_embed_body\\\\\\\\\\\\\">\\\\\\\\n  <p>';\n      const end = '<\\\\/p>\\\\\\\\n\\\\\\\\n\\\\\\\\n<\\\\/div>';\n\n      return text\n        .substring(\n          text.lastIndexOf(start) + start.length,\n          text.lastIndexOf(end)\n        )\n        .replace(/<br>\\\\\\\\n/g, '\\n');\n    },\n    { suspense: true }\n  ) as SuspenseResponseInterface;\n};\n","import React from 'react';\nimport styled from '@emotion/styled';\n\nimport { LyricsSource, useLyrics } from './useLyrics';\n\ninterface LyricsDisplayProps {\n  source: LyricsSource;\n}\n\nexport default function LyricsDisplay({ source }: LyricsDisplayProps) {\n  const { data } = useLyrics(source);\n\n  return <Container>{data}</Container>;\n}\n\nconst Container = styled.pre`\n  font-size: 16px;\n  line-height: 26px;\n`;\n"],"sourceRoot":""}