{"version":3,"sources":["features/songs/lyrics/useLyrics.ts","features/songs/lyrics/LyricsDisplay.tsx"],"names":["timeout","ms","Promise","resolve","setTimeout","LyricsDisplay","data","source","useSWR","geniusSongId","a","fetch","res","text","substring","startIndex","endIndex","replace","suspense","revalidateOnFocus","revalidateOnReconnect","revalidateOnMount","useLyrics","Container","styled","pre"],"mappings":"8MAEA,SAASA,EAAQC,GACf,OAAO,IAAIC,SAAQ,SAACC,GAAD,OAAaC,WAAWD,EAASF,MAiB/C,I,SCXQ,SAASI,EAAT,GAAwD,IAC7DC,EDUe,SAACC,GACxB,OAAOC,YAAO,UAAD,OACDD,EAAOE,cADN,sBAEX,8BAAAC,EAAA,sEACQV,EAAQ,KADhB,uBAGoBW,MAAM,4BAAD,OACOJ,EAAOE,aADd,cAHzB,cAGQG,EAHR,gBAMqBA,EAAIC,OANzB,cAMQA,EANR,yBAQSA,EACJC,UAAUP,EAAOQ,WAAYR,EAAOS,UACpCC,QAAQ,aAAc,OAV3B,2CAYA,CACEC,UAAU,EACVC,mBAAmB,EACnBC,uBAAuB,EACvBC,mBAAmB,IC7BNC,CADmD,EAA9Bf,QAC9BD,KAER,OACE,eAACiB,EAAD,+BAEE,uBACA,uBACCjB,KAKP,IAAMiB,EAAYC,IAAOC,IAAV","file":"static/js/5.5b2f5200.chunk.js","sourcesContent":["import useSWR, { SWRResponse } from 'swr';\n\nfunction timeout(ms: number) {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n}\n\nexport interface LyricsSource {\n  provider: 'genius';\n  locale: 'zh_HK_R';\n  geniusSongId: string;\n  startIndex: number;\n  endIndex: number;\n}\n\ntype Lyrics = string;\n\ninterface SuspenseResponseInterface extends SWRResponse<Lyrics, any> {\n  data: Lyrics;\n}\n\nexport const useLyrics = (source: LyricsSource) => {\n  return useSWR(\n    `lyrics/${source.geniusSongId}`,\n    async () => {\n      await timeout(1000);\n\n      const res = await fetch(\n        `https://genius.com/songs/${source.geniusSongId}/embed.js`\n      );\n      const text = await res.text();\n\n      return text\n        .substring(source.startIndex, source.endIndex)\n        .replace(/<br>\\\\\\\\n/g, '\\n');\n    },\n    {\n      suspense: true,\n      revalidateOnFocus: false,\n      revalidateOnReconnect: false,\n      revalidateOnMount: false,\n    }\n  ) as SuspenseResponseInterface;\n};\n","import React from 'react';\nimport styled from '@emotion/styled';\n\nimport { LyricsSource, useLyrics } from './useLyrics';\n\ninterface LyricsDisplayProps {\n  source: LyricsSource;\n}\n\nexport default function LyricsDisplay({ source }: LyricsDisplayProps) {\n  const { data } = useLyrics(source);\n\n  return (\n    <Container>\n      Powered by Genius\n      <br />\n      <br />\n      {data}\n    </Container>\n  );\n}\n\nconst Container = styled.pre`\n  font-size: 16px;\n  line-height: 26px;\n`;\n"],"sourceRoot":""}