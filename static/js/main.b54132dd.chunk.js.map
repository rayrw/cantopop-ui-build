{"version":3,"sources":["common/transition/TransitionContext.tsx","app/lazy.ts","features/songs/list/SongListSkeleton.tsx","app/RouteSwitch.tsx","features/songs/songsAPI.ts","features/songs/details/SongDetailsSkeleton.tsx","features/songs/details/YouTubePlayerSkeleton.tsx","features/songs/lyrics/LyricsSectionSkeleton.tsx","features/songs/lyrics/LyricsDisplaySkeleton.tsx","common/transition/ProgressBar.tsx","common/layout/Header.tsx","common/layout/Layout.tsx","app/App.tsx","reportWebVitals.ts","index.tsx"],"names":["TransitionContext","createContext","nextState","TransitionProvider","children","Provider","value","useState","useTransition","useContext","lazy","factory","factoryPromise","LoadedComponent","LazyComponent","React","Component","forwardRef","props","ref","createElement","Object","assign","preload","then","module","default","SongListSkeleton","Container","Array","from","keys","map","i","SongListItem","styled","div","SongListPage","SongDetailPage","RouteSwitch","exact","path","fallback","SongDetailsSkeleton","timeout","ms","Promise","resolve","setTimeout","songsAPI","fetchAll","fetch","process","res","json","fetchById","songId","id","artist","title","youtubeId","youtube_id","lyrics","rawLyrics","provider","locale","geniusSongId","genius_song_id","startIndex","start_index","endIndex","end_index","PageContainer","SongContainer","SongDetailsContainer","SongTitle","LyricsContainer","UpcomingContainer","UpcomingSong","YouTubePlayerSkeleton","LyricsSectionSkeleton","LyricsLanguageMenu","LyricsLanguageMenuItem","LyricsDisplaySkeleton","Block","width","height","ProgressBar","active","progress","keyframes","css","Header","transition","setTransition","history","useHistory","handleTransition","a","all","mutate","push","HomeLink","onClick","Layout","App","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.b54132dd.chunk.js","sourcesContent":["import React, { createContext, useContext, useState } from 'react';\n\nconst useBooleanState = (initState: boolean) => useState<boolean>(initState);\ntype ContextType = ReturnType<typeof useBooleanState>;\n\nexport const TransitionContext = createContext([\n  false,\n  (nextState: boolean) => {},\n] as ContextType);\n\nexport const TransitionProvider = ({\n  children,\n}: {\n  children: React.ReactNode;\n}) => (\n  <TransitionContext.Provider value={useState<boolean>(false)}>\n    {children}\n  </TransitionContext.Provider>\n);\n\nexport const useTransition = () => useContext(TransitionContext);\n","/**\n * Copied and modified from this library\n * https://github.com/ianschmitz/react-lazy-with-preload\n */\n\nimport React, { ComponentType, createElement, forwardRef } from 'react';\n\nexport type PreloadableComponent<T extends ComponentType<any>> = T & {\n  preload: () => Promise<void>;\n};\n\nexport function lazy<T extends ComponentType<any>>(\n  factory: () => Promise<{ default: T }>\n): PreloadableComponent<T> {\n  const LazyComponent = React.lazy(factory);\n  let factoryPromise: Promise<void> | undefined;\n  let LoadedComponent: T | undefined;\n\n  const Component = forwardRef(function LazyWithPreload(props, ref) {\n    return createElement(\n      LoadedComponent ?? LazyComponent,\n      Object.assign(ref ? { ref } : {}, props) as any\n    );\n  }) as any as PreloadableComponent<T>;\n\n  Component.preload = () => {\n    if (!factoryPromise) {\n      factoryPromise = factory().then((module) => {\n        LoadedComponent = module.default;\n      });\n    }\n\n    return factoryPromise;\n  };\n  return Component;\n}\n","import React from 'react';\nimport styled from '@emotion/styled';\n\nexport function SongListSkeleton() {\n  return (\n    <Container>\n      {Array.from(Array(100).keys()).map((i) => (\n        <SongListItem key={i} />\n      ))}\n    </Container>\n  );\n}\n\nconst Container = styled.div`\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n  grid-gap: 20px;\n`;\n\nconst SongListItem = styled.div`\n  background: #292929;\n  width: 200px;\n  height: 47px;\n`;\n","import React, { Suspense } from 'react';\nimport { Route, Switch } from 'react-router-dom';\n\nimport { lazy } from 'app/lazy';\nimport { SongListSkeleton } from 'features/songs/list/SongListSkeleton';\nimport { SongDetailsSkeleton } from 'features/songs/details/SongDetailsSkeleton';\n\nexport const SongListPage = lazy(\n  () => import('features/songs/list/SongListPage')\n);\nexport const SongDetailPage = lazy(\n  () => import('features/songs/details/SongDetailsPage')\n);\n\nexport function RouteSwitch() {\n  return (\n    <Switch>\n      <Route exact path=\"/\">\n        <Suspense fallback={<SongListSkeleton />}>\n          <SongListPage />\n        </Suspense>\n      </Route>\n      <Route exact path=\"/songs/:songId\">\n        <Suspense fallback={<SongDetailsSkeleton />}>\n          <SongDetailPage />\n        </Suspense>\n      </Route>\n    </Switch>\n  );\n}\n","function timeout(ms: number) {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n}\n\nexport const songsAPI = {\n  async fetchAll() {\n    await timeout(1500);\n    const res = await fetch(`${process.env.REACT_APP_API_BASE_URL}/songs/`);\n    const json = await res.json();\n    return json;\n  },\n  async fetchById(songId: string) {\n    await timeout(1500);\n    const res = await fetch(\n      `${process.env.REACT_APP_API_BASE_URL}/songs/${songId}/`\n    );\n    const json = await res.json();\n    return {\n      id: json.id,\n      artist: json.artist,\n      title: json.title,\n      youtubeId: json.youtube_id,\n      lyrics: json.lyrics.map((rawLyrics: any) => ({\n        provider: rawLyrics.provider,\n        locale: rawLyrics.locale,\n        geniusSongId: rawLyrics.genius_song_id,\n        startIndex: rawLyrics.start_index,\n        endIndex: rawLyrics.end_index,\n      })),\n    };\n  },\n};\n","import React from 'react';\nimport styled from '@emotion/styled';\n\nimport { YouTubePlayerSkeleton } from './YouTubePlayerSkeleton';\nimport { LyricsSectionSkeleton } from '../lyrics/LyricsSectionSkeleton';\n\nexport function SongDetailsSkeleton() {\n  return (\n    <PageContainer>\n      <SongContainer>\n        <YouTubePlayerSkeleton />\n\n        <SongDetailsContainer>\n          <SongTitle />\n          <LyricsContainer>\n            <LyricsSectionSkeleton />\n          </LyricsContainer>\n        </SongDetailsContainer>\n      </SongContainer>\n      <UpcomingContainer>\n        <UpcomingSong />\n        <UpcomingSong />\n        <UpcomingSong />\n        <UpcomingSong />\n        <UpcomingSong />\n      </UpcomingContainer>\n    </PageContainer>\n  );\n}\n\nexport const PageContainer = styled.div`\n  display: flex;\n  flex-direction: row;\n`;\n\nexport const SongContainer = styled.div`\n  width: 70%;\n  margin-right: 20px;\n`;\n\nexport const SongDetailsContainer = styled.div`\n  margin-top: 20px;\n`;\n\nconst SongTitle = styled.div`\n  margin-top: 10px;\n  background: #292929;\n  width: 200px;\n  height: 30px;\n`;\n\nexport const LyricsContainer = styled.div`\n  width: 500px;\n  margin-top: 20px;\n`;\n\nexport const UpcomingContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  width: 30%;\n`;\n\nexport const UpcomingSong = styled.div`\n  width: 100%;\n  height: 150px;\n  background: #292929;\n  margin-bottom: 20px;\n`;\n","import styled from '@emotion/styled';\n\nexport const YouTubePlayerSkeleton = styled.div`\n  padding-bottom: 56.25%; /* 16:9 */\n  width: 100%;\n  height: 0;\n  overflow: hidden;\n  background: #292929;\n`;\n","import React from 'react';\nimport styled from '@emotion/styled';\n\nimport { LyricsDisplaySkeleton } from './LyricsDisplaySkeleton';\n\nexport function LyricsSectionSkeleton() {\n  return (\n    <Container>\n      <LyricsLanguageMenu>\n        {Array.from(Array(2).keys()).map((i) => (\n          <LyricsLanguageMenuItem key={i} />\n        ))}\n      </LyricsLanguageMenu>\n      <LyricsDisplaySkeleton />\n    </Container>\n  );\n}\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n`;\n\nconst LyricsLanguageMenu = styled.div`\n  display: flex;\n  margin-bottom: 20px;\n`;\n\nconst LyricsLanguageMenuItem = styled.div`\n  width: 70px;\n  height: 41px;\n  background: #292929;\n  margin-right: 15px;\n`;\n","import React from 'react';\nimport styled from '@emotion/styled';\n\nexport function LyricsDisplaySkeleton() {\n  return (\n    <Container>\n      {Array.from(Array(30).keys()).map((i) => (\n        <Block key={i} width={350} height={24} />\n      ))}\n    </Container>\n  );\n}\n\nconst Container = styled.div`\n  display: block;\n`;\n\ninterface BlockProps {\n  width: number;\n  height: number;\n}\n\nconst Block = styled.div<BlockProps>`\n  background: #292929;\n  width: ${(props) => `${props.width}px`};\n  height: ${(props) => `${props.height}px`};\n  margin-bottom: 8px;\n`;\n","import React from 'react';\nimport styled from '@emotion/styled';\nimport { keyframes, css } from '@emotion/react';\n\ninterface ProgressBarProps {\n  active: boolean;\n}\n\nexport function ProgressBar({ active = false }: ProgressBarProps) {\n  return <Container active={active} />;\n}\n\ninterface ContainerProps {\n  active: boolean;\n}\n\nconst progress = keyframes`\n  0% {\n    transform: scaleX(0);\n  }\n\n  10% {\n    transform: scaleX(0.3);\n  }\n\n  50% {\n    transform: scaleX(0.7);\n  }\n\n  90% {\n    transform: scaleX(0.8);\n  }\n\n  100% {\n    transform: scaleX(1);\n  }\n`;\n\nconst Container = styled.div<ContainerProps>`\n  position: fixed;\n  height: 3px;\n  width: 100%;\n  top: 0;\n  left: 0;\n  z-index: 1000;\n  transform: scaleX(0);\n  transform-origin: left center;\n  transition: transform ease-in 300ms, opacity ease-in 300ms;\n  transition-delay: 0;\n  background-color: rgb(245, 67, 145);\n  opacity: ${(props) => (props.active ? 1 : 0)};\n  animation-fill-mode: forwards;\n  animation: ${(props) =>\n    props.active &&\n    css`\n      ${progress} 2s cubic-bezier(0.4, 0.45, 0.6, 0.55) infinite;\n    `};\n`;\n","import React from 'react';\nimport styled from '@emotion/styled';\nimport { useHistory } from 'react-router-dom';\nimport { mutate } from 'swr';\n\nimport { SongListPage } from 'app/RouteSwitch';\nimport { songsAPI } from 'features/songs/songsAPI';\nimport { useTransition } from '../transition/TransitionContext';\nimport { ProgressBar } from '../transition/ProgressBar';\n\nexport function Header() {\n  const [transition, setTransition] = useTransition();\n  const history = useHistory();\n\n  const handleTransition = async () => {\n    setTransition(true);\n    await Promise.all([\n      SongListPage.preload(),\n      mutate('songList', songsAPI.fetchAll(), false),\n    ]);\n    setTransition(false);\n    history.push('/');\n  };\n\n  return (\n    <Container>\n      <ProgressBar active={transition ? true : false} />\n      <HomeLink onClick={handleTransition}>Cantopop</HomeLink>\n    </Container>\n  );\n}\n\nconst Container = styled.div`\n  font-size: 16px;\n  background: #0e0e0e;\n  color: #d9d9de;\n  padding: 20px 40px;\n`;\n\nconst HomeLink = styled.a`\n  color: #d9d9de;\n  text-decoration: none;\n  cursor: pointer;\n`;\n","import React from 'react';\nimport styled from '@emotion/styled';\n\nimport { RouteSwitch } from 'app/RouteSwitch';\nimport { Header } from './Header';\n\nexport function Layout() {\n  return (\n    <Container>\n      <Header />\n      <PageContainer>\n        <RouteSwitch />\n      </PageContainer>\n    </Container>\n  );\n}\n\nconst Container = styled.div`\n  background: #000;\n  color: #d9d9de;\n  min-height: 100vh;\n`;\n\nconst PageContainer = styled.div`\n  padding: 30px 40px;\n`;\n","import React from 'react';\nimport { BrowserRouter as Router } from 'react-router-dom';\nimport { Layout } from 'common/layout/Layout';\n\nfunction App() {\n  return (\n    <Router>\n      <Layout />\n    </Router>\n  );\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from 'app/App';\nimport reportWebVitals from './reportWebVitals';\n\nimport { TransitionProvider } from 'common/transition/TransitionContext';\n\nReactDOM.render(\n  <React.StrictMode>\n    <TransitionProvider>\n      <App />\n    </TransitionProvider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}